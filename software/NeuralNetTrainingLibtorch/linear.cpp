#include "Linear.h"

float iWeights[30][91] = { {-0.040756,-0.023982,0.019595,0.016534,0.080511,-0.035482,-0.023451,0.100255,-0.039168,-0.043787,-0.042683,0.075611,-0.031318,0.049515,-0.050569,0.016681,0.026457,-0.027259,0.082007,0.074089,0.082304,-0.096706,0.003652,-0.102834,-0.024081,-0.055197,-0.006747,-0.021990,-0.059767,-0.104506,0.096506,0.061666,-0.037297,-0.088732,-0.010155,0.087239,0.089465,0.003789,-0.078747,-0.063896,-0.057234,0.008933,0.013245,-0.098741,-0.081308,-0.086937,0.029172,0.025917,-0.016577,-0.035371,-0.056275,-0.086451,-0.047741,0.096858,0.038792,-0.011451,0.018589,-0.069352,-0.043747,0.013382,0.044027,-0.055599,-0.030691,-0.041371,-0.002116,0.068154,-0.035665,-0.061290,-0.082526,0.031312,-0.002520,0.048072,-0.071088,-0.091502,-0.076742,-0.003875,-0.051395,-0.048148,0.000889,0.044854,0.100702,-0.003685,0.096296,-0.055883,0.065841,-0.073818,-0.063473,0.072669,-0.074376,0.048707,-0.002709},
{-0.025264,0.022401,0.040224,-0.039247,0.019375,-0.009752,-0.005845,-0.009615,-0.006141,0.045052,0.036694,-0.049578,-0.082041,-0.107960,-0.005426,0.064022,0.031434,0.040409,0.043759,-0.055190,-0.001129,-0.030123,-0.061708,-0.091365,-0.023694,0.070961,0.021074,-0.058635,-0.051370,0.014001,0.080729,-0.069584,-0.085314,0.049428,-0.013718,0.033999,0.026485,0.045396,0.035390,-0.016714,0.025768,0.080356,-0.093614,-0.084279,0.029269,-0.046101,0.085306,0.048857,0.000898,-0.052906,0.078670,0.002357,-0.018146,0.087841,-0.086139,0.003546,0.092791,-0.052244,-0.074104,-0.077896,0.071473,0.071259,-0.032336,0.003839,-0.008785,-0.004797,-0.100773,-0.066021,0.007638,0.079145,-0.104385,-0.035240,-0.037627,0.023922,-0.031886,-0.061750,-0.080038,0.016107,0.078593,-0.006314,0.017821,-0.085640,-0.011062,0.038473,-0.025254,0.065475,0.082891,0.015657,-0.008519,-0.058073,0.088665},
{-0.050647,0.002470,-0.070087,-0.013929,-0.009919,-0.012921,0.065294,-0.039746,-0.080717,0.089342,-0.046402,-0.046039,-0.052558,-0.030476,-0.062780,0.045988,-0.010707,0.053193,0.057180,-0.070538,-0.026638,-0.020385,0.096550,-0.049546,-0.057659,0.058430,0.072559,0.001212,-0.050122,0.074914,-0.091326,0.087240,-0.007866,0.086489,-0.059348,0.096438,-0.046992,-0.035196,-0.048022,0.074569,0.078473,-0.045314,0.073619,-0.097825,0.096297,-0.059656,-0.084195,-0.075287,0.032461,-0.057781,0.096928,0.070940,-0.050509,0.039457,0.013463,0.002788,-0.084225,0.071894,0.005730,-0.107533,-0.060366,0.026563,-0.081922,-0.074567,-0.077441,0.077848,0.081126,-0.019482,-0.015695,0.090809,-0.060542,0.013813,-0.029826,0.029664,-0.102395,-0.016023,0.067756,-0.003877,0.048021,0.075676,-0.026040,-0.049288,0.032909,-0.048393,-0.017847,0.038427,-0.054512,-0.071812,0.085303,0.007434,-0.009868},
{-0.100688,0.053257,-0.112730,0.060012,0.043466,0.085596,-0.104695,0.013872,-0.057299,0.019528,-0.072222,0.017135,0.029547,-0.068277,-0.103606,-0.011671,0.049823,-0.022559,0.028730,0.074430,-0.105706,0.024660,0.053932,-0.027714,0.024491,-0.090418,-0.017216,-0.112764,-0.116304,-0.085139,0.032122,-0.094830,0.088885,0.077416,0.015254,-0.005675,0.085597,0.058453,-0.095822,0.033954,0.054480,-0.088989,-0.013057,-0.073253,-0.072273,-0.033100,-0.057281,-0.068394,0.029415,0.043221,-0.059616,-0.099383,0.089956,0.003841,-0.087248,-0.068994,0.021178,-0.082055,0.000180,0.008236,0.038090,-0.049048,-0.013906,0.002372,0.013320,0.034662,-0.013189,-0.025562,-0.080949,0.079592,-0.058639,-0.009534,-0.046095,-0.054722,-0.000156,-0.091532,0.049379,-0.075104,-0.041497,-0.040435,0.070641,-0.067100,0.006616,0.064901,-0.032224,0.064059,-0.010956,0.047193,0.015580,-0.088083,0.077848},
{0.025035,-0.047020,0.016364,-0.055102,-0.026811,-0.072435,0.086966,0.062305,0.102839,-0.009892,-0.059283,-0.090277,-0.089193,0.096386,-0.018488,-0.009408,-0.084279,-0.078876,0.075969,-0.073962,-0.017255,0.068877,0.087265,-0.046124,-0.055236,-0.080120,-0.083592,0.053829,0.013380,0.044503,-0.076849,-0.026964,0.000965,-0.104635,0.085744,-0.005020,0.068174,-0.055107,0.095602,0.006325,0.028394,0.085961,0.008382,0.064482,-0.055152,-0.018290,-0.023118,0.087264,-0.074422,-0.076848,-0.082734,0.086298,-0.054541,0.024430,0.097767,0.088890,-0.092283,-0.064843,-0.069322,-0.054798,0.084211,-0.084311,-0.072531,0.002642,-0.019778,-0.103960,-0.064303,0.067297,-0.088535,0.098623,0.081049,-0.097759,-0.055452,-0.083517,0.011014,-0.089432,0.004731,0.066409,0.040478,0.103965,0.039548,0.097906,-0.069310,-0.035270,0.079916,0.062076,-0.063319,-0.019728,-0.067048,0.044983,0.005639},
{0.020403,0.023380,-0.028546,-0.012854,0.040683,0.012991,0.021581,0.008236,0.050597,-0.070103,0.072548,-0.092024,-0.062454,-0.069747,-0.057808,-0.059035,0.077759,-0.019460,-0.014598,-0.026311,0.052128,-0.092051,-0.056736,0.033628,-0.073308,-0.034738,-0.077461,-0.057675,0.078980,-0.043598,-0.061089,0.039166,-0.003719,0.074780,-0.033422,-0.036450,0.040747,-0.040316,-0.032648,-0.089736,0.024674,-0.033278,-0.092373,0.085636,0.098576,-0.047366,0.057013,0.089834,-0.084145,0.006650,0.021488,-0.017133,0.098136,-0.006886,0.062876,-0.052004,-0.054677,0.023193,0.049871,0.030137,-0.029678,-0.065740,-0.055279,-0.009163,-0.069242,-0.043674,0.030697,-0.059721,0.073340,-0.023534,0.079753,-0.016938,-0.091437,-0.012979,0.020235,-0.053453,-0.048850,0.061629,0.027420,-0.066136,-0.071777,-0.067567,0.078779,-0.061545,-0.047818,-0.066324,0.026609,-0.035965,-0.047111,0.087618,-0.086259},
{0.261423,0.099445,-0.628926,-1.078150,-0.666130,-0.580800,-1.016806,0.756371,0.134702,-0.058962,-0.037797,0.421115,0.851591,1.768392,-0.386955,0.572838,-0.346120,-0.612152,-0.163055,-0.343837,0.935204,0.251043,0.323963,-0.756265,-0.598704,-0.227916,-0.222221,1.146071,1.687157,0.030902,-0.457288,-0.387161,0.357233,0.788288,1.979968,1.422525,1.488346,0.856797,0.180825,-0.171045,-0.354485,0.114068,0.791626,1.578597,1.082455,0.229008,-0.324666,-0.768966,-0.545089,-0.763192,0.397143,-0.074836,-0.531152,-0.742528,-0.773159,-0.266392,0.222202,-0.255634,-0.724323,-0.820507,-0.788932,-0.109808,0.627671,0.798639,0.884700,-0.300696,-0.444677,-0.166480,0.716947,1.138312,0.064300,0.878720,-0.170304,0.352045,0.636867,0.895240,1.448254,-0.313348,1.056269,0.795638,0.783543,0.757543,1.103377,1.020447,-0.810076,0.386403,-0.617358,-0.092289,0.370838,0.728280,0.742252},
{0.583764,0.386544,0.571310,0.363297,0.373439,-0.124028,-1.443929,-0.601882,-0.053584,0.416911,0.111110,-0.414894,-0.696197,-1.529191,-0.697959,0.402598,0.129090,-0.236200,-0.948239,-0.104553,-1.269568,-0.752109,0.978871,1.074162,0.761592,-0.147660,0.300024,-1.573782,-1.175820,1.638521,2.107486,1.505418,0.817041,-0.278867,-2.639481,-1.889199,1.367608,1.874040,1.008949,-0.211880,-1.311397,-2.817612,-0.904665,0.580344,1.219631,0.690249,-0.301096,-1.200332,-2.108773,0.328034,0.694975,0.758614,0.320454,-0.345058,-0.863015,-1.685237,-0.766193,0.528413,0.998510,0.322495,-0.259947,-0.694972,-1.341769,-0.904497,-0.624699,0.337113,-0.059310,-0.730824,-0.690972,-0.858991,-0.612144,-0.725269,0.081919,0.082479,0.041632,0.062232,0.052999,-0.425063,-0.830182,0.489245,0.448561,0.512419,0.187407,0.422158,-0.358462,-1.450036,0.142498,0.229881,0.420855,0.610865,0.951453},
{0.075194,-0.045186,-0.047743,0.016301,0.037303,0.023272,0.036065,-0.093055,-0.104286,-0.103650,-0.035591,-0.032734,0.001908,-0.086523,-0.060510,-0.013354,0.022726,0.058317,0.058274,0.053980,0.060406,0.090575,-0.020808,0.061890,0.041750,0.086638,-0.068819,-0.073642,0.099721,-0.101057,0.097615,-0.075921,-0.071550,0.001249,0.090015,-0.034936,-0.068811,-0.081181,-0.046293,0.059890,-0.011526,0.073031,0.008661,-0.076270,0.028207,0.095335,0.004577,0.098173,0.058501,-0.010747,0.037757,-0.061559,-0.084569,0.040250,0.040248,0.060055,-0.080647,-0.027958,0.037845,0.067638,0.059934,-0.066070,0.090708,0.091206,0.087475,-0.029295,-0.017834,-0.068842,0.038937,-0.000184,0.038281,-0.042917,-0.050124,-0.029224,-0.057911,-0.031007,-0.054856,0.064768,0.075010,-0.023373,0.032281,-0.091506,0.088548,-0.059471,-0.102191,-0.015457,-0.028970,-0.071595,-0.077503,0.055532,-0.034136},
{-0.276543,0.159928,0.235592,-0.077051,-0.189287,1.388374,0.949705,-1.037017,0.250520,0.183033,-0.091586,-0.782972,0.589507,-0.544693,-0.506272,0.479697,0.509275,0.208856,-0.677853,1.407369,0.575594,-0.467412,0.953997,0.866668,0.299984,-0.192266,1.660851,0.746015,-1.343377,0.813291,0.817396,0.749381,0.042998,0.371950,-1.923644,-1.660730,0.251768,0.672261,1.297827,0.638500,-0.103020,-1.812388,-0.819653,-0.070134,0.365728,0.751330,0.040692,-0.230917,-1.107651,-0.471243,-0.553743,-0.281783,0.075812,-0.154706,0.135240,-0.776924,-0.295697,-0.290625,-0.091435,0.015564,0.053450,0.215497,-0.481316,-0.118659,-0.741641,0.070624,0.480982,0.147708,0.265846,-0.169905,0.207663,-0.602879,0.415533,-0.059211,-0.088772,0.249267,-0.012513,0.361247,-0.870507,-0.179903,0.040484,-0.054551,-0.042637,0.091843,-0.565038,-1.149098,-0.382569,-0.709891,-0.609209,0.208725,0.645455},
{-0.371309,-0.327083,0.526110,0.470693,-0.581114,-0.779247,1.466590,0.817456,0.912638,1.372020,1.365142,0.705368,-0.500704,1.206031,0.639501,0.868535,1.339632,1.487710,0.819222,-1.676831,-0.459462,-0.022193,-0.465910,0.403667,1.041668,0.910075,-1.601357,-0.498275,-0.699567,-0.329853,0.542236,0.729469,0.326512,-1.624970,-0.274322,-1.539954,0.850639,0.946053,1.048373,0.090023,-2.013882,-0.796976,-0.360142,0.578641,0.837206,0.917479,0.113246,-1.961676,-1.745134,1.123098,-0.117692,0.596480,0.914115,0.238228,-1.444958,-1.098994,0.794244,-0.358639,0.254749,0.490264,0.339547,-0.911495,-0.547752,0.277857,0.316627,0.471785,0.583763,0.636992,-0.226377,-0.102352,0.403259,0.006121,0.323156,0.362478,0.266894,-0.412725,-0.244575,1.222932,-0.116810,0.464022,0.052458,0.300949,-0.221249,-0.794619,0.291415,-0.335604,0.189564,-0.051040,-0.073782,-0.437483,-0.808221},
{-0.464872,-0.513256,-0.303951,-0.845759,-0.082686,1.947749,0.642856,-0.781468,0.563355,0.143257,-0.408939,-0.484792,1.445966,-0.184971,0.006145,0.486281,0.719056,0.055142,-0.281098,2.107444,0.428288,0.014156,1.000942,0.888691,0.264247,-0.086768,1.369554,-0.868760,-0.325102,0.516803,0.646868,0.819872,0.140074,0.479592,-2.204538,-0.671011,0.132535,0.409912,0.813183,0.482512,0.336787,-1.740991,-0.111186,0.531365,0.702236,0.989750,0.459211,0.765245,-0.123497,-0.335136,0.053495,0.206337,0.312357,0.406681,1.193404,0.298085,-0.253804,0.047679,0.158414,0.361723,0.278754,0.906969,0.312890,0.748742,-0.317757,0.391272,0.263383,-0.147488,0.420051,-0.095581,0.458114,-0.305985,0.117574,-0.238593,-0.120577,0.144622,0.129170,0.965111,-0.499808,-0.304157,-0.101251,0.195694,0.328880,0.188090,0.280663,-0.940011,-0.085132,-0.748558,-0.281152,0.264145,0.464426},
{0.111213,0.195325,-0.366766,-0.331361,0.227862,-0.861795,-0.771603,0.692064,-0.336301,-0.281227,-0.053298,0.849183,0.210406,0.959116,-0.173350,-0.455232,-0.700855,-0.686877,0.278502,-0.679500,0.943862,0.832873,0.011590,-0.556611,-0.228317,0.446980,-0.050359,1.923743,2.131290,-0.043111,-0.495088,-0.442839,0.888182,1.309164,3.076751,1.926552,0.213937,-0.129685,-0.956916,-0.426594,0.244905,1.768083,0.156599,0.046634,-0.445076,-1.236937,-0.955313,-0.825290,0.265188,-1.576055,-0.113962,-0.518381,-0.990747,-0.716385,-0.595024,0.423633,0.190148,-0.885981,-1.371178,-1.218376,-0.497317,0.407803,1.401894,0.403117,0.893822,-0.712308,-0.472058,0.341569,1.121796,1.431499,0.275934,1.149583,-0.023590,0.458912,0.534221,0.661105,1.066425,-0.566331,0.901240,0.039359,0.144623,0.080121,0.502969,0.540873,-0.324617,1.222990,-0.124717,0.119479,0.293529,0.050861,0.206001},
{-0.271314,-0.520795,-0.362027,-0.820842,-0.545353,-0.798673,0.875164,0.678378,0.409447,0.696924,0.690679,0.849072,0.052761,1.879604,0.043600,0.331868,0.666849,0.436066,0.652530,-1.478091,0.558814,0.504083,-0.425971,-0.232480,0.205855,0.918322,-0.883568,1.353974,1.125541,-0.825329,-0.601466,-0.083718,0.558629,-0.402363,1.705299,0.346851,0.895314,0.851361,0.770054,0.178987,-1.490548,0.070817,0.274533,0.712048,0.748279,0.521703,-0.071324,-1.654235,-0.972480,0.598929,-0.268071,0.055517,0.274169,0.238087,-1.085719,-0.222321,1.176339,-0.541848,-0.167702,0.167906,0.250186,0.081609,0.565621,1.214130,0.776807,0.402824,0.539495,0.758071,0.527227,0.785065,0.639702,0.542493,0.159145,0.389159,0.358259,0.124905,0.458206,1.120378,0.756672,0.050512,-0.173017,0.224314,0.342933,-0.038359,-0.221419,0.430733,-0.413485,-0.641180,-0.380949,-0.316739,-0.487274},
{0.237184,0.622493,-0.153702,-0.185363,-0.036397,1.231530,0.503629,0.767093,0.408523,-0.209051,-0.230484,0.160207,1.999320,1.389569,0.931306,1.119848,0.541056,0.020683,0.188442,2.452741,1.927965,-0.197635,1.142983,0.136540,-0.400316,-0.478448,1.371006,0.793669,-1.286546,-1.275616,-1.704035,-1.513007,-1.689830,0.155364,-1.182923,0.128434,-1.254977,-1.166319,-0.726756,-0.720603,-0.065267,-1.165513,0.034343,-0.467000,-0.435716,-0.281722,-0.090787,0.185265,-0.089108,0.111845,-0.115585,-0.200227,-0.223789,0.081261,0.834376,0.195076,0.290027,0.503438,0.483394,0.238330,0.276464,0.905403,0.528366,0.444428,0.170275,0.151651,0.052338,-0.016657,0.509702,0.133843,-0.080092,0.581793,0.198366,-0.033123,0.017059,0.318337,0.193821,-0.734372,0.255417,0.018088,0.264643,-0.066837,-0.007499,0.317226,-1.226866,0.208433,-0.570809,-0.390951,-0.258793,0.050484,0.213442},
{0.382344,0.256159,0.087094,0.475504,0.753741,0.482529,0.708262,-0.752167,-0.943970,-1.051249,-0.448175,-0.535215,-0.989871,-1.497213,-0.758575,-1.568666,-1.081957,-0.343164,-0.231316,0.144211,0.144011,0.275457,-1.264204,-0.651151,-0.274878,0.831455,1.861794,2.214964,0.052265,0.416111,0.441041,0.678948,1.029202,1.906818,1.559466,-0.338727,1.147105,1.340789,1.448663,2.004377,2.222806,1.977176,0.128714,0.711012,0.648140,0.899696,1.339131,1.999019,1.563990,-0.002931,0.032937,-0.084487,0.010380,0.660170,1.592340,0.607403,-0.308255,-0.114557,-0.245578,-0.060305,0.433162,1.001835,-0.224102,-0.302445,-0.052759,0.225925,0.332160,0.483709,0.533665,-0.257471,0.669151,0.478857,1.130664,0.832644,0.623841,0.599789,-0.236131,-0.974282,-0.515022,-0.289340,-0.760740,-1.037766,-1.148807,-0.898691,-0.257389,-0.384543,-0.318229,-0.539355,-0.817264,-0.281784,-0.423131},
{-0.005690,1.124707,0.380456,-0.220332,-0.177826,0.788556,-0.040012,-1.388845,0.137757,-0.527273,-0.932399,-1.193295,0.626758,0.715346,-0.986126,0.461928,-0.304180,-0.997106,-1.269248,0.870771,1.214830,0.122895,1.918154,0.652985,0.075404,-0.894376,0.785390,0.761675,1.532449,2.023934,0.984624,0.673235,0.207640,1.239766,0.992191,1.816159,0.818579,0.282053,0.065648,-0.454281,0.780361,0.322578,0.696059,0.274461,-0.114932,-0.123141,-0.421181,0.449954,0.525838,-0.674968,0.593048,0.279354,0.027055,-0.026176,0.375710,0.678337,-0.432953,0.567559,0.500041,0.175546,-0.157186,0.025189,0.450992,-0.605698,-0.216192,-0.420541,-0.592981,-0.957124,-0.485638,0.065931,-0.551116,-0.493333,-0.309412,-0.110470,-0.266873,0.347539,0.903829,-0.289931,-0.056566,0.208948,0.768473,0.733007,1.263332,1.499362,-0.435778,-0.139710,0.192061,0.583766,0.638393,1.097283,1.640282},
{-0.355220,-0.331850,0.057305,-0.309376,-0.206739,0.961443,1.670918,0.763727,0.712470,0.715089,0.517794,0.651406,1.405987,1.422844,0.895617,0.149897,0.620212,0.893241,0.933591,1.019437,1.068531,0.916575,0.605394,0.867299,0.751828,0.921695,0.699193,0.638276,0.672093,-0.587239,-0.450257,-0.192634,-0.402771,-0.105017,-0.222025,0.288064,-0.935232,-0.913053,-0.115663,-0.142917,-0.245157,-0.437575,-0.332300,-0.508805,-0.545851,0.013712,-0.409635,-0.525413,-0.269837,-0.343764,-1.052737,-0.865577,-0.307910,-0.174020,-0.073604,0.254852,0.123592,-0.834164,-0.589564,-0.096362,0.193584,0.274209,0.618263,0.733258,0.394709,0.238067,0.451558,0.743698,0.492646,0.124949,0.965917,0.821041,0.296551,-0.120667,0.227521,-0.188098,-0.278338,0.958455,0.523264,-0.710604,-0.638484,-0.499925,-0.323901,-0.966072,0.472578,1.211788,0.122556,-0.392330,-0.607847,-0.559346,-1.041516},
{0.331581,-0.903081,0.045721,0.304916,0.817346,-0.076533,-0.392502,1.392860,0.276150,0.978893,0.911044,1.188739,-0.182577,-0.734248,1.469332,-0.223357,0.721723,1.142892,1.604072,-0.050965,-1.011227,0.798928,-0.470084,0.796488,1.283251,1.553896,-0.215256,-1.535296,-0.181118,-0.795156,0.333767,0.602975,0.637548,-0.484294,-1.147608,-1.503349,-0.794063,-0.367390,-0.075742,0.068690,-0.788283,-1.344171,-1.059088,-0.661355,-0.187368,-0.158059,-0.000674,-0.916298,-1.030503,0.202127,-0.830228,-0.367551,-0.076249,0.186080,-0.391164,-0.737377,0.122943,-0.786746,-0.627509,-0.174858,0.045719,-0.111340,-0.431742,1.110896,0.080440,0.254629,0.267923,0.891809,0.454776,-0.109562,1.437774,0.668282,0.311736,0.108261,0.396632,-0.049003,-0.252838,1.806690,0.515390,0.241602,-0.188401,0.099120,-0.268809,-0.847045,1.173337,0.547766,0.635267,-0.053023,-0.142373,-0.616842,-1.006758},
{1.049525,-0.259616,-0.050527,0.482036,0.608161,-1.258227,-1.157573,1.087894,-0.240685,0.313067,0.933883,1.121231,-1.370477,-1.436320,-0.022944,-0.338997,-0.034996,0.450227,0.552781,-1.290213,-1.149207,-0.083440,-0.751672,-0.145526,0.574025,1.219801,0.098538,0.662592,-0.584834,-0.112314,0.388314,0.582185,1.122936,0.242194,0.667998,-1.411134,0.886214,1.044743,0.723005,0.854347,-0.498513,0.098102,-0.931745,0.257658,0.535866,0.286798,0.311339,-1.239762,-1.370942,0.089564,-0.771829,-0.480366,-0.721798,-0.613153,-2.229129,-2.249649,0.023127,-1.244860,-1.101988,-1.048415,-0.813454,-1.181645,-1.895936,-0.695574,-0.931126,-1.146911,-0.971675,-0.285157,-0.639542,-0.738046,-0.999646,-0.345503,-0.327939,-0.508318,-0.073361,-0.209336,-0.302131,-1.253057,0.154473,0.073338,-0.234390,-0.032764,-0.249075,-0.246494,-1.109292,-0.635627,-0.563252,-0.562702,-0.189554,-0.220311,-0.345762},
{0.014300,-0.087233,-0.015721,-0.086416,-0.048967,-0.043274,-0.026105,-0.056322,-0.029320,0.064637,0.101927,0.103266,0.016546,0.034757,0.077938,-0.000901,0.096169,0.073951,-0.072684,-0.043119,0.052861,-0.045816,0.014987,0.041744,-0.001329,0.088803,-0.080830,0.092995,0.049184,-0.001947,0.005370,-0.030465,0.066998,0.015011,-0.033135,-0.079947,-0.085004,-0.086630,-0.048693,-0.066704,-0.075477,-0.094786,-0.068834,0.050354,-0.050157,0.040716,-0.035865,0.060196,0.045800,0.030310,-0.000012,0.035782,0.021508,0.091166,-0.018456,-0.062320,0.007547,-0.004760,-0.058173,-0.081313,-0.062810,-0.068108,-0.066236,0.054025,0.076130,0.088053,0.087628,0.025891,-0.070960,0.071605,0.057927,-0.063254,-0.036823,0.075068,-0.006495,0.047963,0.018185,0.093410,0.090622,0.041272,0.099088,-0.022370,0.015744,0.085410,0.072319,-0.025586,-0.104550,0.032933,-0.053469,-0.015117,-0.038765},
{0.462076,0.638491,0.595272,0.315331,0.401022,0.701122,-0.196401,0.778559,0.891710,0.539001,0.101830,0.365618,1.287802,1.100147,0.761211,0.908854,0.107465,-0.215951,-0.004531,0.600381,-0.069683,-0.264346,0.689043,-0.054846,-0.296396,-0.988990,-1.016051,-2.541402,-0.268899,0.559453,0.143644,-0.215440,-0.614474,-0.705748,-2.110525,0.715377,-0.192810,-0.577065,-0.799154,-1.187195,-0.650512,-1.402482,0.232392,0.462445,-0.157609,-0.345661,-0.603849,0.182216,-0.261329,-0.505171,1.062256,0.357290,-0.160550,-0.421110,0.153492,0.026780,-0.941429,0.924488,0.573836,0.001149,-0.456640,-0.313172,-0.272738,-0.967058,-0.123913,-0.162975,-0.585761,-1.081578,-0.773785,-0.438047,-0.115697,0.006847,-0.351159,-0.193966,-0.245451,-0.001331,0.302273,0.906262,0.655900,0.710022,0.975750,1.063123,1.086619,0.720328,0.751616,1.030064,1.111702,1.335621,1.252816,0.906921,0.643940},
{-0.712858,0.365291,0.459078,0.436650,0.203606,0.974522,2.040020,-1.484704,0.002512,-0.388382,-0.228783,-1.048700,-0.174338,-0.101123,-0.301733,-0.375964,0.146709,0.399240,-0.063919,0.406175,1.134529,0.967206,0.755832,1.044009,0.777189,0.680938,1.248982,2.738278,1.403919,0.797089,0.273444,0.501125,0.176312,1.259477,2.540143,1.678576,-1.103957,-0.863548,-0.009253,0.770246,1.733883,2.907929,0.448194,-1.706863,-1.182486,-0.471473,0.403083,0.966500,2.295898,-0.042711,-0.580620,-0.165295,0.677925,1.032831,1.637166,2.600919,1.138590,0.441020,0.476833,0.771994,0.930460,1.332904,1.948567,0.190898,0.019639,-0.036245,0.437785,0.566904,0.387368,0.816519,-0.372500,-0.625931,-0.494190,-0.206179,-0.422167,-0.165531,-0.019799,0.253573,-0.525327,-1.158198,-0.702413,-0.867668,-0.310886,0.163651,0.305476,0.137340,0.066459,-0.471847,-0.468185,-0.180856,-0.121621},
{-0.011924,0.769640,1.225250,1.563759,0.412779,-0.959534,1.006899,-0.922001,0.083540,0.649673,0.797996,-0.567416,-2.020734,-0.879276,-0.246679,0.126903,0.628326,1.021056,-0.090276,-2.045506,-0.679635,0.419890,0.157220,1.010638,1.225861,0.620198,-0.637159,1.033783,0.026711,0.699291,0.750759,0.751047,0.259280,-0.640663,1.084062,-0.503636,-0.258552,-0.112707,0.059180,0.209090,-0.356548,1.288368,-0.395366,-1.361336,-0.653742,-0.514284,-0.079123,-0.779885,0.114775,0.824887,-0.333116,0.298586,0.596701,0.694031,-0.625531,0.329601,0.346111,0.345583,0.945051,0.875397,0.568896,-0.523948,0.005528,-0.981527,-0.400811,0.093800,0.293654,0.388874,-0.687154,-0.055280,-0.559461,-0.922980,-0.215782,-0.001035,-0.164871,-0.559038,-0.490306,0.234028,-1.060599,-0.076266,-0.188763,-0.236045,-0.381240,-0.125815,0.295956,-0.418454,0.550967,0.354706,0.182296,-0.232762,-0.210332},
{-0.913058,0.152326,-0.055175,-1.020393,-1.179644,1.225438,2.418730,-1.268239,0.769630,0.196924,-0.145711,-0.961801,1.196190,1.713599,-0.944666,0.999818,0.805128,0.090481,-0.806088,0.789235,2.147560,0.387292,1.181071,0.534706,0.090997,0.180993,1.242014,2.835994,0.742327,0.450186,0.143031,0.262215,0.024972,0.745511,1.530305,0.671334,0.727284,0.699905,1.465282,0.850866,-0.361182,-0.032056,-0.073821,0.206746,0.461425,1.055247,0.001650,-1.209403,-0.791935,-0.594281,-0.849197,-0.360640,0.420715,0.059996,-0.293978,0.164784,0.877643,-1.034476,-0.815234,-0.249432,-0.104339,0.243881,0.872914,0.981443,-0.008322,-0.260903,0.207317,0.188857,0.579695,0.897685,0.115953,-0.175934,-0.112523,-0.314435,-0.173193,0.080915,0.651197,0.930837,-0.095680,-0.728789,-0.357336,-0.172419,0.489012,0.572909,-1.088288,0.023643,-0.714176,-1.151294,-0.624431,0.332082,0.686341},
{0.082063,0.083945,-0.032393,-0.071609,-0.074105,-0.073651,0.079357,-0.008032,0.051686,0.104692,0.037417,-0.030592,-0.083801,0.020328,-0.051048,0.028577,-0.017256,-0.014878,-0.087996,0.018726,-0.002480,-0.075312,0.035032,-0.026953,0.064378,-0.041366,-0.057746,0.013454,-0.038727,-0.010475,-0.022728,0.050958,0.103978,0.044734,0.025363,0.020318,-0.048518,0.044215,-0.080103,-0.013126,0.041068,0.102142,0.102596,0.080413,-0.043573,0.028497,-0.026605,0.100355,0.042656,-0.086198,-0.009219,-0.064432,0.001774,0.048845,-0.031027,0.004316,0.065905,0.098663,-0.102064,0.084179,-0.098475,0.088868,-0.072675,0.084108,0.075622,0.040895,-0.093497,-0.027858,-0.053377,0.036850,-0.077874,-0.083883,-0.018809,0.038503,0.075552,0.031731,0.059455,0.084039,-0.069020,0.091236,-0.091716,-0.001879,0.041883,0.098622,0.030443,-0.083519,0.005067,-0.066076,0.083232,0.050750,0.091143},
{1.233130,-0.019944,-0.547504,-0.013392,0.894811,0.494433,-1.703240,2.481798,0.491291,0.394836,0.778018,2.065354,1.706817,-0.351284,0.905243,0.290030,-0.236802,0.043209,1.103590,1.632975,0.013727,-1.042431,-0.821800,-1.505800,-1.561667,-0.900145,0.655626,-0.257409,-1.999321,-1.570111,-1.923186,-2.009205,-1.291109,0.252703,-0.558437,-0.008105,-0.714960,-0.761070,-0.772319,-0.030160,0.786076,-0.145411,0.900767,0.421909,0.167995,-0.056973,0.822574,1.431795,0.713809,0.286858,0.823705,0.234807,-0.234765,0.301584,1.352582,0.375770,-0.305202,0.493611,-0.080335,-0.151911,0.238956,1.058314,0.333516,-0.004173,0.468485,0.141404,-0.032903,0.110802,0.844278,0.007827,0.161402,1.130295,0.560559,0.246820,0.604202,0.578798,0.021589,-1.494241,0.778975,-0.022155,-0.053383,-0.289657,-0.321875,-0.129623,-1.336804,0.125622,-0.649215,-0.302039,-0.448601,-0.198564,-0.254253},
{1.090845,-0.164214,0.465656,1.103830,1.471056,0.203581,-1.763173,0.587529,-0.387936,0.298492,0.435993,0.737580,-0.953525,-2.728945,0.520603,-0.432600,-0.048369,0.450472,0.651914,0.246611,-1.890493,-0.221368,-0.307208,0.721216,0.781971,0.434600,0.321179,-2.494173,-1.267201,0.277212,0.958080,0.792339,0.546765,-0.189162,-2.562117,-1.393143,-0.560767,-0.043739,-0.147357,0.330361,0.711866,-1.009135,-0.222696,-0.196584,0.203086,0.139249,0.856724,1.415951,0.401614,1.096601,0.749247,0.829337,0.503434,0.761536,1.010365,-0.112022,-0.508131,1.022275,1.283438,0.987665,0.707711,0.442866,-0.720954,-0.506509,0.065126,0.987773,0.660521,0.608392,0.091138,-0.643443,0.159248,-0.393676,0.741834,0.319179,0.479412,0.041498,-0.473338,-0.565387,-0.545133,0.063184,0.031657,0.079916,-0.510968,-0.306030,1.126976,-0.508945,0.837082,0.913405,0.494902,0.102319,-0.078263},
{0.022010,-0.028048,0.067290,-0.038404,-0.104484,-0.016734,0.091249,-0.029061,0.060183,0.039212,0.025555,-0.021563,-0.035583,-0.073403,-0.015383,-0.091096,-0.027187,-0.088966,-0.083172,-0.075323,-0.015440,-0.067091,0.011609,-0.100976,0.002962,-0.075344,0.101306,-0.088060,0.087363,-0.083795,-0.089704,-0.057077,-0.062999,-0.054909,-0.072795,-0.101045,0.098015,0.004408,0.086478,-0.006993,0.002785,-0.018997,0.048395,-0.030144,0.084975,-0.046176,0.018702,-0.096101,-0.040381,-0.053677,0.022134,-0.090368,0.067487,0.057302,0.085583,-0.021021,-0.087419,-0.068415,0.036070,0.085718,-0.073091,-0.081150,-0.008236,-0.044275,0.081679,-0.014049,-0.103800,0.099710,-0.017051,0.069681,-0.047104,0.002906,-0.077865,-0.092203,-0.050742,0.081615,-0.013430,-0.067000,-0.063978,0.055088,-0.018795,0.104750,-0.049748,-0.079562,0.077741,0.029721,-0.057561,0.025521,0.044398,-0.043361,-0.003819},
{0.608024,-1.162412,-0.079142,0.467742,1.150910,-0.861292,-0.273183,1.573197,-0.416709,0.364855,0.910380,1.551067,-1.066837,-1.083041,1.405939,-1.115792,0.055175,1.026318,1.835743,-0.734192,-0.879945,0.932604,-1.649888,-0.019025,0.725527,1.573985,0.015957,0.158171,1.024649,-0.915303,0.328229,0.573571,1.530807,0.710452,1.309447,-0.366401,-0.776818,-0.121474,0.115885,1.137882,0.748642,1.163157,-0.580655,-1.288755,-0.373825,-0.251854,0.497479,0.134733,0.372542,0.011757,-1.176417,-0.455852,-0.419027,0.064419,-0.502949,-0.656470,0.003010,-1.109411,-0.593318,-0.361585,-0.178862,-0.192936,-1.206741,-0.470450,-0.954219,-0.832043,-0.942800,-0.449268,-0.785228,-1.433972,-0.346106,-0.261166,-0.738813,-1.278803,-1.044314,-1.076259,-1.257762,0.057752,-0.316772,-0.722929,-1.117695,-0.970903,-0.885343,-1.222798,1.349933,0.892810,0.514385,0.076190,-0.280609,-0.812628,-1.299266} };
float oWeights[8][30] = { {0.015519,-0.110069,-0.103247,-0.120652,0.034136,0.139096,-2.339543,-0.433751,0.099336,0.284108,0.491300,0.185062,-1.226664,-0.144976,-0.810596,0.938795,-1.609666,0.507032,0.686974,0.860520,0.068050,-1.661826,0.868913,0.845225,0.160113,-0.131272,-1.267879,0.539784,0.115419,1.656375},
{-0.032111,0.155856,-0.071430,-0.116014,-0.141523,-0.129344,-0.440785,0.908709,-0.026112,0.916037,1.027719,1.009323,-2.371344,0.027504,-0.169197,-1.441408,0.399366,-0.017274,-0.395981,-1.221207,0.114135,0.992923,-0.690899,-0.131802,1.025099,0.004042,-2.824864,-0.443295,0.033904,-3.348573},
{-0.129118,-0.185307,0.054262,-0.080717,-0.122395,0.170935,0.553454,0.635013,0.142235,-0.803813,0.602343,-0.308652,0.405830,0.642319,-2.353572,-1.958088,-0.665037,-0.790472,0.706371,1.281938,0.022677,-0.093008,-0.950418,0.065901,-0.941072,-0.169582,-0.744503,0.725200,0.178082,1.153647},
{0.088657,-0.093067,-0.155178,0.075198,0.108604,0.002573,1.161551,-2.283058,0.042335,-0.610989,-0.989691,0.106424,1.308813,0.700482,0.797172,-1.529838,0.733777,1.000314,-0.906504,-3.012146,0.125618,-0.078311,1.389229,-1.108094,1.497324,-0.105408,-0.227279,-2.436812,0.122946,-0.604590},
{-0.137194,-0.180375,-0.076992,-0.033032,0.071789,0.012140,0.721294,0.215017,-0.127946,-0.171730,0.088175,-1.095527,0.911313,0.362067,-0.077880,0.515232,0.302222,-1.860973,-2.548946,0.938177,-0.161270,-1.236396,-0.069132,0.707412,0.387465,-0.113313,0.561973,-0.997777,-0.032033,-1.541609},
{0.174647,-0.004979,0.064089,-0.035021,0.030686,0.092719,0.037205,0.432626,-0.024443,0.612393,-2.267265,0.936179,-0.319071,-1.235368,1.708434,1.863763,0.499387,0.065364,-0.121101,-0.389224,-0.060415,0.068554,-0.362180,-1.618737,-0.158283,-0.059776,1.670823,0.446224,0.104130,-1.074868},
{-0.037357,-0.110800,-0.007644,0.071852,0.141183,-0.166843,-1.404589,0.385252,-0.091742,-0.399141,-1.228315,-0.298994,-0.439637,-1.784626,-1.425275,-0.332915,1.150090,-1.558913,-0.885065,-1.779827,-0.005091,1.173377,1.072639,1.274410,-1.220669,0.123712,-2.046630,1.050340,0.001245,-0.338556},
{-0.121216,0.134888,-0.185035,-0.108597,0.099890,0.171800,0.074146,-1.165904,0.106475,-1.516329,0.705843,-1.214124,0.248225,0.329283,0.406829,0.185863,-1.981810,0.442462,0.839019,0.807617,-0.174021,0.705740,-1.874297,-0.862342,-2.113509,-0.163053,1.239939,0.172681,-0.135869,1.723465} };

float iBiases[30] = { -0.064562,-0.112027,-0.069314,-0.013535,-0.023669,-0.053630,1.016158,0.521125,-0.100976,-0.085390,-0.249790,-0.068483,0.826415,0.242827,0.064313,-0.315620,0.847670,-0.570312,-0.378321,0.235479,-0.092527,0.438546,-0.106540,0.029481,0.043568,-0.071406,0.212237,0.036275,-0.082988,-0.311320 };
float oBiases[8] = { -0.549131,-0.136154,0.537240,0.032964,0.310916,-0.088590,0.347049,-0.082294 };

Linear::Linear(int numInput, int numHidden, int numOutput)
{
	this->numInput = numInput;
	this->numHidden = numHidden;
	this->numOutput = numOutput;
}

Linear::~Linear()
{
	delete[] oSums;
	delete[] hSums;
}

int Linear::forward(char input[][NUM_BANDS])
{
	char* inputFlatten = flatten(input);
	//divide_(255.0f, inputFlatten, numInput);

	setZero_(hSums, numHidden);
	setZero_(oSums, numOutput);

	for (int i = 0; i < numHidden; i++)
	{
		for (int j = 0; j < numInput; j++)
		{
			hSums[i] += ((float)inputFlatten[j] / 255.0f) * iWeights[i][j];
			//std::cout << inputFlatten[j] << std::endl;
		}

		hSums[i] += iBiases[i];
		//std::cout << hSums[i] << std::endl;
	}

	relu(hSums, numHidden);

	for (int i = 0; i < numHidden; i++)
	{
		std::cout << hSums[i] << std::endl;
	}

	for (int i = 0; i < numOutput; i++)
	{
		for (int j = 0; j < numHidden; j++)
		{
			oSums[i] += hSums[j] * oWeights[i][j];
		}

		oSums[i] += oBiases[i];

		printf("%f ", oSums[i]);
	}

	softMax(oSums, numOutput);

	delete[] inputFlatten;

	return indexOfMax(oSums, numOutput);
}

char* Linear::flatten(char input[NUM_SEGMENTS][NUM_BANDS])
{
	char* out = new char[numInput];
	int index = 0;

	for (int i = 0; i < NUM_SEGMENTS; i++)
	{
		for (int j = 0; j < NUM_BANDS; j++)
		{
			out[index] = input[i][j];
			index++;
		}
	}

	return out;
}

void Linear::divide_(float divider, char input[], int size)
{
	for (int i = 0; i < size; i++)
	{
		input[i] /= divider;
	}
}

void Linear::setZero_(float input[], int size)
{
	memset(input, 0, size * sizeof(float));
}

int Linear::indexOfMax(float input[], int size)
{
	int maxIndex = 0;

	for (int i = 0; i < size; i++)
	{
		maxIndex = input[i] > input[maxIndex] ? i : maxIndex;
	}

	return maxIndex;
}